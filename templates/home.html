
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-title" content="Image Captioning App">

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <title>Generic Data Collection</title>
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
        <link rel="stylesheet" href="{{ url_for('static', filename='src/leaflet.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='src/css/bootstrap.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='src/plugins/Leaflet.PolylineMeasure.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='src/plugins/easy-button.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='src/css/font-awesome.min.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='src/plugins/leaflet.awesome-markers.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='src/plugins/MarkerCluster.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='src/plugins/MarkerCluster.Default.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='generic_mobile_resources/css_generic_mobile.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='generic_mobile_resources/app.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='generic_mobile_resources/new-age.min.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='generic_mobile_resources/new-age.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">



        <script src="{{ url_for('static', filename='src/leaflet.js') }}"></script>
        <script src="{{ url_for('static', filename='src/jquery-3.3.1.min.js') }}"></script>
        <script src="{{ url_for('static', filename='src/plugins/Leaflet.PolylineMeasure.js') }}"></script>
        <script src="{{ url_for('static', filename='src/plugins/easy-button.js') }}"></script>
        <script src="{{ url_for('static', filename='src/plugins/leaflet-providers.js') }}"></script>
        <script src="{{ url_for('static', filename='src/plugins/leaflet.awesome-markers.min.js') }}"></script>
        <script src="{{ url_for('static', filename='src/plugins/leaflet.markercluster.js') }}"></script>
        <script src="{{ url_for('static', filename='src/plugins/leaflet.geometryutil.js') }}"></script>
        <script src="{{ url_for('static', filename='js/general_functions.js') }}"></script>
        <script src="{{ url_for('static', filename='js/general_editing.js') }}"></script>
        <script src="{{ url_for('static', filename='generic_mobile_resources/js_generic_mobile.js') }}"></script>
        <script src="{{ url_for('static', filename='js/capture.js') }}"></script>
        <script src="{{ url_for('static', filename='js/new-age.min.js') }}"></script>

    </head>
    <body>

        <!--  home screen -->

        <div id="divHeader" class="col-xs-12">
                <div class="col-xs-12"><h4 id="mode" class="text-center"><a href="/logout" >
                    <i class="fa fa-sign-out fa-2x" aria-hidden="true"></i></a></h4></div>


        </div>
        <div id="divMap" class="col-xs-12">
                <div id="homepage" class="container">
                        <h1>Welcome</h1>

                    </div>

        </div>
        <div id="divFooter" class="col-xs-12" >
            <div class="btn-group btn-group-justified" >
                <div class="btn-group">
                    <button id="btnMap" class="btn btn-warning"><i class="fas fa-home fa-2x"></i></button>
                </div>
                <div class="btn-group">
                    <button id="btnInfo" class="btn btn-warning"><i class="fa fa-info fa-2x"></i></button>
                </div>
                <div class="btn-group">
                    <button id="btnLayers" class="btn btn-warning"><i class="fa fa-camera fa-2x"></i></button>
                </div>
                <div class="btn-group">
                    <button id="btnPoints" class="btn btn-warning"><i class="fa fa-list-alt fa-2x"></i></button>
                </div>


            </div>
        </div>

        <!--  Subscreens -->

        <div id="divInfo" class="modal">
            <div class="sub-header"><h3 class="text-center">Mix Your Styles</h3></div>

            <div id="info">
                    <header class="masthead">
                    <div class="container h-100">
                            <div class="row h-100">
                                <div class="col-lg-7 my-auto">
                                    <div id="loading" style="text-align: center">
                                        <h6>Processing Takes Some time due to computational Power </h6>
                                        <div id="loading-gif"></div>
                                        <p>Loading...</p>

                                    </div>
                                    <div class="header-content mx-auto" id="content">
                                        <h1 class="mb-5">Mix and Style Your Images</h1>
                                        <h3>Upload Images</h3>
                                        <form method=post action="/mix" enctype=multipart/form-data>
                                            <p>Content File</p>
                                            <input type=file class="btn btn-outline btn-xl" name=content-file id="content-file" >
                                            <p></p>
                                            <p>Style File

                                                <!-- <a target=_blank href=" {{ url_for('static', filename='img/style1.jpg') }}"></a> -->
                                            </p>
                                            <input type=file class="btn btn-outline btn-xl" name=style-file id='style-file'>
                                            <!-- <input type=submit class="btn btn-outline btn-xl" data-loading-text="Loading..." value="Upload" onclick="loading();"> -->
                                            <input type=submit class="btn btn-outline btn-xl" data-loading-text="Loading..." value="Upload Files">


                                        </form>
                                    </div>
                                </div>
                                <div class="col-lg-5 my-auto ">
                                    <div class="device-container ">
                                        <div class="device-mockup iphone6_plus gold">
                                            <div class="device ">
                                                <div class="screen ">
                                                    <!-- Demo image for screen mockup, you can put an image here, some HTML, an animation, video, or anything else! -->
                                                    <!-- <img src="/static/img/demo-screen-1.gif " class="img-fluid " alt=" "> -->
                                                    <video controls="controls" autoplay muted class="img-fluid" width="404" height="720">
                                                        <source src="/neural_style/static/img/demo.mov">
                                                    </video>
                                                </div>
                                                <div class="button ">
                                                    <!-- You can hook the "home button " to some JavaScript events or just remove it -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


               <!-- <form method="POST" action="/send" role="form", name="gisform">
                <div class="col-xs-6">Content Image</div>
                <div class="col-xs-6">Style Image</div>
                <div class="col-xs-6">
                      <input type="file" class="form-control" name="info_cur_lat" id="info_cur_lat" placeholder="Upload Content Image" >
                </div>


                <div class="col-xs-6">
                      <input type="file" class="form-control" name="info_cur_alt" id="info_cur_alt" placeholder="Upload Style Image" >
                </div>


                <div class="col-xs-6">
                        <input type="text" class="form-control" name="info_cur_lng" id="info_cur_lng" placeholder="" >
                  </div>
                </div>
                < submit botton--
                <div class="col-xs-6">
                      <input type="submit" value="submit button" class="btn">
                </div>
                </form>
                <div style="margin-left:175px; margin-top:460px; float:left; position:absolute;">


                -->
             </div>
        </div>

        <div id="divLayers" class="modal">
            <div class="sub-header"><h3 class="text-center">Capture</h3></div>
            <div id="layers">

                          <main>
                                <div class="controls">
                                  <button id="button">Get camera</button>
                                  <select id="select">
                                    <option></option>
                                  </select>
                                </div>

                                <video id="video" autoplay playsinline></video>
                                <img id="snap" name="selfie">

                                <p id="error-message"></p>

                                <div class="controls">

                                  <button><a href="#" id="delete-photo" title="Delete Photo" class="disabled"><i class="fa fa-trash fa-3x"  aria-hidden="true" ></i></a></button>
                                  <button><a href="#" id="take-photo" title="Take Photo"><i class="fa fa-camera fa-4x" aria-hidden="true"></i></a></button>
                                  <button><a href="#" id="download-photo" download="selfie.jpeg" title="Save Photo" class="disabled"><i class="fa fa-arrow-circle-down fa-3x" aria-hidden="true"></i></a></button>
                                  <button><a href="/uploads" id="upload-photo" upload="selfie.jpeg" title="Upload Photo" class="disabled" accept="image/"><i class="fa fa-arrow-circle-up fa-3x" aria-hidden="true"></i></a></button>
                                <!-- Hidden canvas element. Used for taking snapshot of video. -->
                              </div>
                              <div>
                              <canvas id='canvas'></canvas>
                            </div>


                              </main>
            </div>
          <div>

          </div>
        </div>
        <div id="divPoints" class="modal">
            <div class="sub-header"><h3 class="text-center">Caption</h3></div>
            <div id="points"></div>
            <header class="masthead">
                <div class="container h-100">
                    <div class="row h-100">
                        <div class="col-lg-7 my-auto">
                            <div id="loading" style="text-align: center">
                                <h6>Warning: This web app is experimental and still in development. Processing in neural network takes
                                    few seconds due to the limited computational capacity. </h6>
                                <div id="loading-gif"></div>
                                <p>Loading...</p>

                            </div>
                            <div class="header-content mx-auto" id="content">
                                <h1 class="mb-5">Caption Your Image</h1>
                                <h3>Upload Image</h3>
                                <form method=post action="/uploads" enctype=multipart/form-data>
                                    <input type=file class="btn btn-outline btn-xl" name=file>
                                    <p></p>
                                    <!--<input type=submit class="btn btn-outline btn-xl" data-loading-text="Loading..." value="Upload" onclick="loading();"-->
                                    <input type=submit class="btn btn-outline btn-xl" data-loading-text="Loading..." value="Upload">

                                </form>
                            </div>
                        </div>
                        <div class="col-lg-5 my-auto ">
                            <div class="device-container ">
                                <div class="device-mockup iphone6_plus black">
                                    <div class="device ">
                                        <div class="screen ">
                                            <!-- Demo image for screen mockup, you can put an image here, some HTML, an animation, video, or anything else! -->
                                            <!-- <img src="/caption-it/static/img/demo-screen-1.gif " class="img-fluid " alt=" "> -->
                                            <video controls="controls" autoplay muted class="img-fluid" width="404" height="720">
                                                <source src="/caption-it/static/img/demo.mp4">
                                            </video>
                                        </div>
                                        <div class="button ">
                                            <!-- You can hook the "home button " to some JavaScript events or just remove it -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                             <!-- Bootstrap core JavaScript -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="/neural_style/static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="/neural_style/static/vendor/jquery-easing/jquery.easing.min.js "></script>

    <!-- Custom scripts for this template -->
    <script src="/static/js/new-age.min.js "></script>
    <script type="text/javascript">// <![CDATA[
        function loading() {
            $("#loading").show();
            $("#loading-gif").show();
            $("#content").hide();
        }
    // ]]></script>

                  <!--<script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
                  <script type="text/javascript">// <![CDATA[
                    function loading() {
                        $("#loading").show();
                        $("#loading-gif").show();
                        $("#content").hide();-->



                <!--
                    <script type="text/javascript">

                       $(".myButton").click(function(){
                           var $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
                           var canvasObj = document.getElementById("canvas");
                           var img = canvasObj.toDataURL();
                           $.ajax({
                               type: "POST",
                               url: $SCRIPT_ROOT + "/predict/",
                               data: img,
                               success: function(data){
                                   $('#result').text(data);
                               }
                           });


               </script>-->
        </div>



                 </div>
            </div>
        </div>

        <script>


            $(document).ready(function(){

                //  ********* Map Initialization ****************


                //   *********** Layer Initialization **********


//              ******  Load Data  ******

// ********* Setup Layer Control  ***************



                objOverlays = {
                    "Breadcrumbs":lyrBreadcrumbs
                };

                ctlLayers = L.control.layers(objBasemaps, objOverlays).addTo(mymap);

                ctlMeasure = L.control.polylineMeasure({position:'topright'}).addTo(mymap);



                // ************ Location Events **************

                setInterval(function(){
                    mymap.locate();
                    var dt=new Date();
                    var tsf=((dt-posLastTime)/1000).toFixed(0);
                    $(".time_since_fix").html(tsf);
                }, 1000);

//                populateInfo();
                intInfo = setInterval(function(){
                    populateInfo();
                }, $("#numBreadcrumbs").val()*1000)

                mymap.on('locationfound', function(e) {
                    $(".info_cur_acc").html(e.accuracy.toFixed(1));
                    if ($("#btnFilter").html()=="On") {
                        var flt=$("#numFilter").val();
                    } else {
                        var flt=100000;
                    }
                    if (e.accuracy<flt){
                        posCurrent=randomizePos(e);
                        posLastTime=new Date();
                    } else {
                        if (posCurrent) {
                            posCurrent.accuracy=e.accuracy;
                        }
                    }
                });

                mymap.on('locationerror', function(e) {
                    console.log(e);
                })

                if (localStorage.jsnSettings) {
                    var jsnSettings=JSON.parse(localStorage.jsnSettings);
                    $("#btnAutolocate").html(jsnSettings.autolocate);
                    $("#numAutolocate").val(jsnSettings.numAutolocate);
                    $("#valAutolocate").html(jsnSettings.numAutolocate);
                    if (jsnSettings.autolocate=="On") {
                        startAutolocate();
                    }
                    $("#btnBreadcrumbs").html(jsnSettings.breadcrumbs);
                    $("#numBreadcrumbs").val(jsnSettings.numBreadcrumbs);
                    $("#valBreadcrumbs").html(jsnSettings.numBreadcrumbs);
                    if (jsnSettings.breadcrumbs=="On") {
                        startBreadcrumbs();
                    }
                    $("#btnFilter").html(jsnSettings.filter);
                    $("#numFilter").val(jsnSettings.numFilter);
                    $("#valFilter").html(jsnSettings.numFilter);
                }
            });

            $("#btnMap").click(function(){
                openSubScreen();
            })
            $("#btnInfo").click(function(){
                openSubScreen("divInfo");
            })
            $("#btnLayers").click(function(){
                openSubScreen("divLayers");
            })
            $("#btnhome").click(function(){
                openSubScreen("divLayers");
            })
            $("#btnPoints").click(function(){

                openSubScreen("divPoints");
            })
            $("#btnSettings").click(function(){
                openSubScreen("divSettings");

            })

            $("#btnAutolocate").click(function(){
                if ($("#btnAutolocate").html()=="On"){
                    stopAutolocate();
                } else {
                    startAutolocate();
                }
            });

            $("#numAutolocate").on("change", function(){
                $("#valAutolocate").html($("#numAutolocate").val());
                startAutolocate();
            });

            $("#btnBreadcrumbs").click(function(){
                if ($("#btnBreadcrumbs").html()=="On"){
                    stopBreadcrumbs();
                } else {
                    startBreadcrumbs();
                }
            });

            $("#numBreadcrumbs").on("change", function(){
                $("#valBreadcrumbs").html($("#numBreadcrumbs").val());
                startBreadcrumbs();
            });

            $("#btnFilter").click(function(){
                if ($("#btnFilter").html()=="On"){
                    $("#btnFilter").html("Off");
                    storeSettings();
                } else {
                    $("#btnFilter").html("On");
                    storeSettings();
                }
            });

            $("#numFilter").on("change", function(){
                $("#valFilter").html($("#numFilter").val());
                storeSettings();
            });

        </script>
    </body>
</html>
